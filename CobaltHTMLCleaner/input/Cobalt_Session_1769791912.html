<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cobalt - Session Viewer</title>
    <link
      rel="icon"
      type="image/png"
      href="https://cobalt-xil.pages.dev/Assets/Logo.png"
    />
    <style>
      :root {
        --bg-color: #0b0b0b;
        --surface-color: #161b22;
        --border-color: #30363d;
        --text-primary: #c9d1d9;
        --text-secondary: #8b949e;
        --accent-blue: #58a6ff;
        --accent-green: #3fb950;
        --accent-orange: #d29922;
        --accent-red: #ff7b72;
        --font-family: "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI",
          Helvetica, Arial, sans-serif;
      }

      body {
        background-color: var(--bg-color);
        color: var(--text-primary);
        font-family: var(--font-family);
        margin: 0;
        padding: 0;
        font-size: 13px;
        height: 100vh;
        display: flex;
        flex-direction: column;
        overflow: hidden;
      }

      /* Top Header */
      .app-header {
        height: 50px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        background-color: var(--bg-color);
        flex-shrink: 0;
        z-index: 10;
      }

      .brand {
        display: flex;
        align-items: center;
        gap: 10px;
        font-size: 16px;
        font-weight: 600;
        color: #fff;
      }

      .brand-icon {
        width: 20px;
        height: 20px;
        background-image: url("https://cobalt-xil.pages.dev/Assets/Logo.png");
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
      }

      .session-container {
        position: relative;
        display: flex;
        flex-direction: column;
        align-items: flex-end;
      }

      .session-info {
        color: var(--text-secondary);
        font-family: monospace;
        font-size: 12px;
        cursor: pointer;
        padding: 2px 5px;
        border-radius: 4px;
        transition: background-color 0.2s ease;
        user-select: none;
      }

      .session-info:hover {
        background-color: #1c2128;
      }

      .session-id {
        color: #fff;
      }

      .session-tooltip {
        position: absolute;
        top: 100%;
        right: 0;
        background-color: #1c2128;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        padding: 10px;
        z-index: 100;
        width: 250px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        margin-top: 5px;
        opacity: 0;
        transform: translateY(-10px);
        pointer-events: none;
        visibility: hidden;
        transition: opacity 0.2s ease, transform 0.2s ease, visibility 0.2s;
      }

      .session-tooltip::before {
        content: "";
        position: absolute;
        top: -10px;
        left: 0;
        width: 100%;
        height: 10px;
        background: transparent;
      }

      .session-container:hover .session-tooltip,
      .session-tooltip.visible {
        opacity: 1;
        transform: translateY(0);
        pointer-events: auto;
        visibility: visible;
      }

      .tooltip-row {
        display: flex;
        justify-content: space-between;
        margin-bottom: 5px;
        font-size: 11px;
      }

      .tooltip-label {
        color: var(--text-secondary);
      }

      .tooltip-value {
        color: var(--text-primary);
        font-family: monospace;
        user-select: text;
      }

      /* Mobile Responsiveness */
      @media (max-width: 768px) {
        .app-header {
          height: auto;
          flex-wrap: wrap;
          padding: 10px;
          gap: 10px;
        }

        .brand {
          font-size: 14px;
        }

        .session-container {
          align-items: flex-start;
          display: none;
          /* Hide session info on mobile to save space */
        }

        .trace-toolbar {
          height: auto;
          flex-wrap: wrap;
          padding: 10px;
          gap: 10px;
          justify-content: space-between;
        }

        /* Hide non-essential info on mobile */
        .trace-toolbar > div:first-child,
        #statsLabel {
          display: none;
        }

        .search-widget {
          width: 100%;
          order: 3;
          margin-top: 5px;
        }

        .view-toggle {
          width: 100%;
          display: flex;
        }

        .view-btn {
          flex: 1;
          text-align: center;
        }

        .row-list {
          width: 60vw;
          /* Use viewport width to prevent runaway expansion */
        }

        .col-list {
          width: 60vw;
          flex: none;
        }

        .details-panel.visible {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          z-index: 1000;
          border-left: none;
        }

        .details-header-top {
          margin-top: 10px;
        }

        /* Fix Details Header Overflow */
        .details-title-group {
          min-width: 0;
          flex: 1;
          margin-right: 10px;
        }

        .details-name-large {
          white-space: nowrap;
          overflow: hidden;
          text-overflow: ellipsis;
        }

        .details-actions {
          flex-shrink: 0;
        }

        /* Allow wrapping for paths on mobile */
        .details-path-row,
        .origin-row,
        .remote-path-copy {
          white-space: normal !important;
          word-break: break-all;
        }
      }

      /* Scrollbars */
      ::-webkit-scrollbar {
        width: 10px;
        height: 10px;
      }

      ::-webkit-scrollbar-track {
        background: #0d1117;
      }

      ::-webkit-scrollbar-thumb {
        background: #30363d;
        border-radius: 5px;
        border: 2px solid #0d1117;
      }

      ::-webkit-scrollbar-thumb:hover {
        background: #8b949e;
      }

      ::-webkit-scrollbar-corner {
        background: var(--bg-color);
      }

      /* Heatmap Styles */
      .heatmap-container {
        flex: 1;
        display: none;
        flex-direction: column;
        overflow: hidden;
        background-color: var(--bg-color);
        position: relative;
      }

      .heatmap-container.visible {
        display: flex;
      }

      .heatmap-canvas {
        flex: 1;
        width: 100%;
        height: 100%;
      }

      .view-toggle {
        display: flex;
        background: #1c2128;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        overflow: hidden;
      }

      .view-btn {
        padding: 4px 12px;
        font-size: 12px;
        cursor: pointer;
        color: var(--text-secondary);
        background: transparent;
        border: none;
        transition: all 0.2s;
      }

      .view-btn.active {
        background: var(--accent-blue);
        color: white;
      }

      .view-btn:hover:not(.active) {
        background: #30363d;
      }

      /* Main Layout */
      .main-container {
        display: flex;
        flex: 1;
        overflow: hidden;
      }

      /* Left Panel: Trace View */
      .trace-panel {
        flex: 1;
        display: flex;
        flex-direction: column;
        border-right: 1px solid var(--border-color);
        min-width: 0;
        overflow: hidden;
      }

      .trace-toolbar {
        height: 40px;
        border-bottom: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        padding: 0 10px;
        gap: 10px;
        background-color: var(--bg-color);
        flex-shrink: 0;
      }

      .search-widget {
        display: flex;
        flex-direction: column;
        background-color: var(--bg-color);
        border: 1px solid var(--border-color);
        border-radius: 6px;
        width: 320px;
        position: relative;
        transition: border-color 0.2s ease, border-radius 0.2s ease;
        box-sizing: border-box;
      }

      .search-widget:focus-within {
        border-color: var(--accent-blue);
      }

      .search-widget:focus-within > .search-options {
        border-color: var(--accent-blue);
      }

      .search-widget.expanded {
        border-bottom-left-radius: 0;
        border-bottom-right-radius: 0;
        border-bottom-color: transparent;
      }

      .search-row {
        display: flex;
        align-items: center;
        padding: 4px;
      }

      .search-chevron {
        cursor: pointer;
        padding: 2px;
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        justify-content: center;
        transition: transform 0.2s ease, color 0.2s ease;
        width: 20px;
        height: 20px;
        border-radius: 4px;
      }

      .search-chevron:hover {
        background-color: rgba(255, 255, 255, 0.1);
        color: var(--text-primary);
      }

      .search-chevron.expanded {
        transform: rotate(90deg);
      }

      .search-input-container {
        flex: 1;
        display: flex;
        align-items: center;
        margin-left: 4px;
      }

      .search-input {
        background: transparent;
        border: none;
        color: var(--text-primary);
        font-size: 12px;
        width: 100%;
        outline: none;
        height: 20px;
      }

      .search-options {
        transition: border-color 0.2s ease, border-radius 0.2s ease;
        display: none;
        padding: 10px;
        border: 1px solid var(--border-color);
        border-top: none;
        background-color: var(--bg-color);
        flex-direction: column;
        gap: 12px;
        position: absolute;
        top: 100%;
        left: -1px;
        right: -1px;
        z-index: 100;
        border-bottom-left-radius: 6px;
        border-bottom-right-radius: 6px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        box-sizing: border-box;
      }

      .search-options.visible {
        display: flex;
      }

      .time-range-row {
        display: flex;
        align-items: center;
        gap: 8px;
        font-size: 11px;
        color: var(--text-secondary);
      }

      .filter-options-row {
        display: flex;
        flex-wrap: wrap;
        gap: 8px;
        padding-top: 8px;
        border-top: 1px solid var(--border-color);
      }

      .filter-checkbox-label {
        display: flex;
        align-items: center;
        gap: 4px;
        font-size: 11px;
        color: var(--text-secondary);
        cursor: pointer;
        user-select: none;
      }

      .filter-checkbox-label:hover {
        color: var(--text-primary);
      }

      .filter-checkbox {
        accent-color: var(--accent-blue);
      }

      .time-input-styled {
        background-color: #161b22;
        border: 1px solid var(--border-color);
        color: var(--text-primary);
        border-radius: 4px;
        padding: 4px 8px;
        width: 60px;
        outline: none;
        font-size: 11px;
        transition: border-color 0.2s ease;
        margin: 0 2px;
      }

      .time-input-styled:focus {
        border-color: var(--accent-blue);
      }

      .unit-select {
        background-color: #161b22;
        border: 1px solid var(--border-color);
        color: var(--text-primary);
        border-radius: 4px;
        outline: none;
        font-size: 11px;
        padding: 3px 6px;
        cursor: pointer;
        transition: border-color 0.2s ease;
      }

      .unit-select:focus {
        border-color: var(--accent-blue);
      }

      .trace-header-row {
        display: flex;
        height: 30px;
        border-bottom: 1px solid var(--border-color);
        background-color: var(--surface-color);
        font-size: 11px;
        color: var(--text-secondary);
        line-height: 30px;
        flex-shrink: 0;
      }

      .col-list {
        width: 300px;
        padding-left: 15px;
        border-right: 1px solid var(--border-color);
        flex-shrink: 0;
        z-index: 5;
        background-color: var(--surface-color);
        box-sizing: border-box;
        /* Match row-list */
      }

      .col-timeline {
        flex: 1;
        position: relative;
        overflow: hidden;
        min-width: calc(100vw - 300px);
      }

      .timeline-ruler {
        position: relative;
        top: 0;
        left: 0;
        height: 100%;
        pointer-events: none;
      }

      .tick {
        position: absolute;
        top: 0;
        bottom: 0;
        border-left: 1px solid #30363d;
        font-size: 10px;
        color: #484f58;
        padding-left: 4px;
      }

      .trace-rows {
        flex: 1;
        overflow: auto;
        /* Ensure both scrollbars appear */
        position: relative;
        contain: strict;
      }

      .virtual-spacer {
        position: absolute;
        top: 0;
        left: 0;
        width: 1px;
      }

      .virtual-content {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
      }

      .trace-row {
        display: flex;
        height: 28px;
        /* align-items: center;  Removed to allow children to stretch */
        cursor: pointer;
        /* border-bottom: 1px solid #1c2128; Moved to children */
        width: fit-content;
        min-width: 100%;
        transition: background-color 0.1s ease;
        box-sizing: border-box;
      }

      .trace-row:hover {
        background-color: #1c2128;
      }

      .trace-row.selected {
        background-color: rgba(88, 166, 255, 0.1);
      }

      .trace-row.hidden {
        display: none;
      }

      .trace-row:hover * {
        background-color: #1c2128;
      }

      .trace-row.selected * {
        background-color: #1c2333;
      }

      .row-list {
        width: 300px;
        padding-left: 15px;
        /* Use box-shadow for sticky border to prevent it from disappearing */
        box-shadow: 1px 0 0 0 var(--border-color);
        border-right: none;
        border-bottom: 1px solid #1c2128;
        /* Added border here */
        display: flex;
        align-items: center;
        overflow: hidden;
        flex-shrink: 0;
        box-sizing: border-box;
        position: sticky;
        left: 0;
        background-color: var(--bg-color);
        z-index: 2;
        transition: background-color 0.1s ease;
        height: 100%;
      }

      .row-timeline {
        flex: 1;
        position: relative;
        height: 100%;
        overflow: hidden;
        border-bottom: 1px solid #1c2128;
        /* Added border here */
        box-sizing: border-box;
        /* Ensure border is inside height */
      }

      .type-icon {
        width: 16px;
        height: 16px;
        margin-right: 8px;
        flex-shrink: 0;
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
      }

      .remote-name {
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        color: var(--text-primary);
        font-size: 12px;
      }

      .timeline-marker {
        position: absolute;
        top: 10px;
        height: 8px;
        min-width: 4px;
        border-radius: 4px;
        opacity: 0.9;
      }

      .timeline-marker.incoming {
        background: linear-gradient(90deg, var(--accent-green), #2ea043);
      }

      .timeline-marker.outgoing {
        background: linear-gradient(90deg, var(--accent-orange), #b08800);
      }

      /* Right Panel: Details */
      .details-panel {
        width: 0;
        opacity: 0;
        background-color: var(--bg-color);
        border-left: 0 solid var(--border-color);
        display: flex;
        flex-direction: column;
        padding: 0;
        box-sizing: border-box;
        overflow-y: auto;
        overflow-x: hidden;
        position: relative;
        flex-shrink: 0;
        transition: width 0.3s cubic-bezier(0.4, 0, 0.2, 1), opacity 0.2s ease,
          padding 0.3s ease;
      }

      .details-panel.visible {
        width: 450px;
        opacity: 1;
        padding: 20px;
        border-left: 1px solid var(--border-color);
      }

      /* Header */
      .details-header-top {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: 10px;
      }

      .details-title-group {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .details-icon-large {
        width: 32px;
        height: 32px;
        background-size: contain;
        background-repeat: no-repeat;
        background-position: center;
      }

      .details-name-large {
        font-size: 20px;
        font-weight: 600;
        color: #fff;
      }

      .details-actions {
        display: flex;
        align-items: center;
        gap: 10px;
      }

      .close-btn {
        cursor: pointer;
        color: var(--text-secondary);
        font-size: 20px;
        transition: color 0.2s ease;
        line-height: 1;
      }

      .close-btn:hover {
        color: #fff;
      }

      /* Unified Badge Style */
      .badge-pill {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 11px;
        font-weight: 600;
        text-transform: uppercase;
        border: 1px solid;
        letter-spacing: 0.5px;
        white-space: nowrap;
      }

      .badge-pill.incoming {
        color: var(--accent-green);
        border-color: var(--accent-green);
      }

      .badge-pill.outgoing {
        color: var(--accent-orange);
        border-color: var(--accent-orange);
      }

      .badge-pill.executor {
        color: var(--accent-green);
        border-color: var(--accent-green);
      }

      .badge-pill.actor {
        color: var(--accent-red);
        border-color: var(--accent-red);
        background: repeating-linear-gradient(
          45deg,
          transparent,
          transparent 2px,
          rgba(255, 123, 114, 0.1) 2px,
          rgba(255, 123, 114, 0.1) 4px
        );
      }

      .details-path-row {
        color: var(--text-secondary);
        font-size: 12px;
        margin-bottom: 20px;
        font-family: monospace;
        white-space: nowrap;
        text-overflow: ellipsis;
        overflow: hidden;
        height: 1.2em;
      }

      .remote-path-copy {
        cursor: pointer;
        color: var(--text-secondary);
        font-size: 12px;
        font-weight: normal;
        transition: color 0.2s ease;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
        width: 25%;
      }

      .remote-path-copy:hover {
        color: var(--accent-blue);
      }

      /* Info Grid 2 */
      .info-grid-2 {
        display: flex;
        gap: 20px;
        margin-bottom: 25px;
      }

      .info-item-2 h4 {
        margin: 0 0 6px 0;
        color: var(--text-secondary);
        font-size: 12px;
        font-weight: normal;
      }

      .info-item-2 div {
        font-size: 11px;
        color: var(--text-primary);
        font-family: monospace;
      }

      /* Info Grid */
      .info-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 20px;
        margin-bottom: 25px;
      }

      .info-item h4 {
        margin: 0 0 6px 0;
        color: var(--text-secondary);
        font-size: 12px;
        font-weight: normal;
      }

      .info-item div {
        font-size: 14px;
        color: var(--text-primary);
        font-family: monospace;
      }

      .clickable-path {
        border-bottom: 1px dashed var(--text-secondary);
        cursor: pointer;
        transition: color 0.2s, border-color 0.2s;
      }

      .clickable-path:hover {
        color: var(--accent-blue);
        border-color: var(--accent-blue);
      }

      /* Content Boxes */
      .content-box {
        border: 1px solid var(--border-color);
        border-radius: 8px;
        padding: 15px;
        margin-bottom: 20px;
        position: relative;
        background-color: rgba(22, 27, 34, 0.5);
      }

      .box-title {
        position: absolute;
        top: -10px;
        left: 10px;
        background-color: var(--bg-color);
        padding: 0 5px;
        font-size: 11px;
        color: var(--text-secondary);
      }

      .caller-header {
        display: flex;
        align-items: center;
        gap: 10px;
        margin-bottom: 15px;
      }

      .caller-icon {
        color: var(--text-secondary);
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .caller-icon svg {
        width: 24px;
        height: 24px;
      }

      .caller-info {
        flex: 1;
        min-width: 0;
        /* Critical for flex child truncation */
      }

      .caller-name {
        color: var(--accent-blue);
        font-family: monospace;
        font-size: 14px;
        margin-bottom: 2px;
      }

      .caller-source {
        color: var(--text-secondary);
        font-size: 11px;
        font-family: monospace;
        height: 1.2em;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
        display: block;
      }

      .flags-row {
        display: flex;
        gap: 10px;
        margin-bottom: 10px;
        align-items: center;
      }

      .origin-row {
        font-size: 12px;
        color: var(--text-primary);
        font-family: monospace;
        display: block;
        white-space: nowrap;
        height: 1.2em;
        overflow: hidden;
        text-overflow: ellipsis;
        width: 35%;
      }

      /* Arguments */
      .args-content {
        font-family: "Consolas", "Monaco", monospace;
        font-size: 12px;
        white-space: pre-wrap;
        overflow-x: auto;
        color: #e0e0e0;
        max-height: 300px;
        overflow-y: auto;
        line-height: 1.5;
      }

      /* Copy Button with Animation */
      .copy-icon-btn {
        position: absolute;
        top: 10px;
        right: 10px;
        background: transparent;
        border: 1px solid var(--border-color);
        border-radius: 4px;
        color: var(--text-secondary);
        cursor: pointer;
        width: 28px;
        height: 28px;
        display: flex;
        align-items: center;
        justify-content: center;
        transition: all 0.2s;
        overflow: hidden;
        /* Ensure check icon doesn't spill out */
      }

      .copy-icon-btn:hover {
        border-color: var(--text-primary);
        color: var(--text-primary);
        background-color: var(--surface-color);
      }

      .copy-icon-btn svg {
        width: 14px;
        height: 14px;
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) scale(1);
        transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      }

      .copy-icon-btn .icon-check {
        transform: translate(-50%, -50%) scale(0);
        color: var(--accent-green);
      }

      .copy-icon-btn.copied .icon-copy {
        transform: translate(-50%, -50%) scale(0);
      }

      .copy-icon-btn.copied .icon-check {
        transform: translate(-50%, -50%) scale(1);
      }

      /* Dropdown */
      .dropdown-menu {
        position: absolute;
        top: 42px;
        /* Button height + spacing */
        right: 10px;
        background-color: #1c2128;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        width: 160px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        z-index: 50;
        display: none;
        overflow: hidden;
      }

      .dropdown-menu.visible {
        display: block;
      }

      .dropdown-item {
        padding: 8px 12px;
        font-size: 12px;
        color: var(--text-primary);
        cursor: pointer;
        transition: background-color 0.2s;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .dropdown-item:hover {
        background-color: var(--accent-blue);
        color: #fff;
      }

      .dropdown-item svg {
        width: 14px;
        height: 14px;
        opacity: 0.7;
      }

      /* Toast Notification */
      .toast-container {
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%) translateY(20px);
        background-color: #1c2128;
        border: 1px solid var(--border-color);
        border-radius: 6px;
        padding: 8px 16px;
        color: #fff;
        font-size: 12px;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.5);
        opacity: 0;
        transition: opacity 0.3s, transform 0.3s;
        pointer-events: none;
        z-index: 1000;
        display: flex;
        align-items: center;
        gap: 8px;
      }

      .toast-container.visible {
        opacity: 1;
        transform: translateX(-50%) translateY(0);
      }

      .toast-container svg {
        width: 16px;
        height: 16px;
        color: var(--accent-green);
      }

      /* Syntax Highlighting */
      .hl-str {
        color: #a5d6ff;
      }

      .hl-num {
        color: #79c0ff;
      }

      .hl-bool {
        color: #ff7b72;
      }

      .hl-key {
        color: #7ee787;
      }

      .hl-nil {
        color: #ff7b72;
      }

      .footer {
        height: 25px;
        border-top: 1px solid var(--border-color);
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: 0 20px;
        background-color: var(--bg-color);
        color: var(--text-secondary);
        font-size: 11px;
        flex-shrink: 0;
      }
    </style>
  </head>

  <body>
    <div class="app-header">
      <a
        href="https://github.com/notpoiu/cobalt/tree/main"
        target="_blank"
        style="text-decoration: none"
      >
        <div class="brand">
          <div class="brand-icon"></div>
          Cobalt - Session Viewer
        </div>
      </a>
      <div class="session-container">
        <div class="session-info">
          Session / <span class="session-id">518aadd0-fce4-4af1-bd66-fa2b6e5b028b</span>
        </div>
        <div class="session-tooltip">
          <div class="tooltip-row">
            <span class="tooltip-label">Start Time (tick)</span>
            <span class="tooltip-value">1769817009.264739</span>
          </div>
          <div class="tooltip-row">
            <span class="tooltip-label">Place ID</span>
            <span class="tooltip-value">126509999114328</span>
          </div>
          <div class="tooltip-row">
            <span class="tooltip-label">Job ID</span>
            <span class="tooltip-value">5e1f8e3a-714d-43a9-949e-0372931e5458</span>
          </div>
        </div>
      </div>
    </div>

    <div class="main-container">
      <!-- LEFT PANEL WRAPPER -->
      <div
        class="left-panel-wrapper"
        style="
          flex: 1;
          display: flex;
          flex-direction: column;
          border-right: 1px solid var(--border-color);
          min-width: 0;
          overflow: hidden;
        "
      >
        <!-- SHARED TOOLBAR -->
        <div class="trace-toolbar">
          <div
            style="
              font-size: 11px;
              color: var(--text-secondary);
              margin-right: 20px;
            "
          >
            Started: 31 Jan 2026, 06:50:09
          </div>
          <div style="flex: 1"></div>
          <div class="view-toggle">
            <button class="view-btn active" onclick="switchView('timeline')">
              Timeline
            </button>
            <button class="view-btn" onclick="switchView('heatmap')">
              Heatmap
            </button>
          </div>
          <div class="divider"></div>
          <div class="search-widget">
            <div class="search-row">
              <div
                class="search-chevron"
                onclick="toggleSearchOptions()"
                id="searchChevron"
              >
                <svg
                  width="16"
                  height="16"
                  viewBox="0 0 16 16"
                  fill="currentColor"
                >
                  <path
                    d="M6 4l4 4-4 4"
                    stroke="currentColor"
                    stroke-width="1.5"
                    fill="none"
                  />
                </svg>
              </div>
              <div class="search-input-container">
                <input
                  type="text"
                  class="search-input"
                  id="filterInput"
                  placeholder="Filter events..."
                  oninput="handleFilterInput()"
                />
              </div>
            </div>
            <div class="search-options" id="searchOptions">
              <div class="time-range-row">
                <span>Time Range:</span>
                <input
                  type="number"
                  class="time-input-styled"
                  id="minTimeInput"
                  placeholder="Start"
                  oninput="handleTimeInput()"
                />
                <span>-</span>
                <input
                  type="number"
                  class="time-input-styled"
                  id="maxTimeInput"
                  placeholder="End"
                  oninput="handleTimeInput()"
                />
                <select
                  class="unit-select"
                  id="timeUnitSelect"
                  onchange="handleTimeInput()"
                >
                  <option value="1">s</option>
                  <option value="0.001">ms</option>
                </select>
              </div>
              <div class="filter-options-row">
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterIncoming"
                    onchange="handleFilterInput()"
                  />
                  Incoming</label
                >
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterOutgoing"
                    onchange="handleFilterInput()"
                  />
                  Outgoing</label
                >
                <div
                  style="
                    width: 1px;
                    height: 14px;
                    background: var(--border-color);
                    margin: 0 4px;
                  "
                ></div>
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterActor"
                    onchange="handleFilterInput()"
                  />
                  Actor</label
                >
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterNonActor"
                    onchange="handleFilterInput()"
                  />
                  Non-Actor</label
                >
                <div
                  style="
                    width: 1px;
                    height: 14px;
                    background: var(--border-color);
                    margin: 0 4px;
                  "
                ></div>
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterArgs"
                    onchange="handleFilterInput()"
                  />
                  Args</label
                >
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterProto"
                    onchange="handleFilterInput()"
                  />
                  Proto</label
                >
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterConst"
                    onchange="handleFilterInput()"
                  />
                  Const</label
                >
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterHash"
                    onchange="handleFilterInput()"
                  />
                  Hash</label
                >
                <label class="filter-checkbox-label"
                  ><input
                    type="checkbox"
                    class="filter-checkbox"
                    id="filterSource"
                    onchange="handleFilterInput()"
                  />
                  Source</label
                >
              </div>
            </div>
          </div>
        </div>

        <!-- TIMELINE VIEW -->
        <div class="trace-panel" id="timelinePanel" style="border-right: none">
          <div class="trace-header-row">
            <div class="col-list">Remote</div>
            <div class="col-timeline" id="timelineHeader">
              <div class="timeline-ruler" id="ruler"></div>
            </div>
          </div>

          <div class="trace-rows" id="rowsContainer">
            <div id="virtualSpacer" class="virtual-spacer"></div>
            <div id="virtualContent" class="virtual-content"></div>
          </div>
        </div>

        <!-- HEATMAP VIEW -->
        <div class="heatmap-container" id="heatmapPanel">
          <div
            id="heatmapScroll"
            style="
              width: 100%;
              height: 100%;
              overflow-x: auto;
              overflow-y: hidden;
              position: relative;
            "
          >
            <div
              id="heatmapSpacer"
              style="
                height: 1px;
                width: 100%;
                position: absolute;
                top: 0;
                left: 0;
                pointer-events: none;
              "
            ></div>
            <canvas
              id="heatmapCanvas"
              class="heatmap-canvas"
              style="
                position: sticky;
                left: 0;
                top: 0;
                width: 100%;
                height: 100%;
              "
            ></canvas>
          </div>
          <div
            id="heatmapTooltip"
            class="heatmap-tooltip"
            style="
              display: none;
              position: absolute;
              background: #1c2128;
              border: 1px solid #30363d;
              padding: 4px 8px;
              border-radius: 4px;
              font-size: 11px;
              color: #c9d1d9;
              pointer-events: none;
              z-index: 100;
            "
          ></div>
        </div>
      </div>

      <!-- RIGHT PANEL -->
      <div class="details-panel" id="detailsPanel">
        <div id="detailsContent"></div>
      </div>
    </div>

    <div class="footer">
      <div>Ended: 31 Jan 2026, 06:51:43</div>
      <span
        id="statsLabel"
        style="
          color: var(--text-secondary);
          font-size: 11px;
          margin-right: 10px;
        "
      >
        222 Events â€¢ 94.21s
      </span>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast-container">
      <svg
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="currentColor"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
        class="lucide lucide-check"
      >
        <path d="M20 6 9 17l-5-5" />
      </svg>
      <span id="toastMessage">Copied to clipboard</span>
    </div>

    <!-- Data Script -->
    <script type="application/json" id="dictionary-data">
      {"53":"{\n    {\n        RemoteEvent = game:GetService(\"ReplicatedStorage\").RemoteEvents.DayDisplay,\n        BindableEvent = {\n            BindableEvent = .Event --[[Nil Parent]]\n        },\n        Name = \"DayDisplay\"\n    }\n}","43":"PlayDeathAnimation","73":"FireEnemyProjectile","63":"{\n    false\n}","47":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Strong Axe\"],\n    \"4_8401342884\",\n    CFrame.new(-21.14165687561, 1.6145405769348, -107.50438690186, -0.97916412353516, 9.6322793297077e-08, -0.20307032763958, 7.65826015936e-08, 1, 1.0506631298313e-07, 0.20307032763958, 8.7325517483805e-08, -0.97916412353516)\n}","37":"Anonymous","67":"AnalyticsTimeFirstPerson","57":"{\n    true\n}","112":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"28_8401342884\",\n    CFrame.new(-669.49224853516, -0.24805209040642, -331.9543762207, -0.97291606664658, -0.0027539331931621, -0.2311422675848, 0.0077148135751486, 0.99898517131805, -0.044375285506248, 0.23102989792824, -0.044956646859646, -0.97190743684769)\n}","115":"{\n    \"FireAllClients\",\n    game:GetService(\"Players\").LocalPlayer.Inventory.Rifle\n}","118":"game:GetService(\"ReplicatedStorage\").RemoteEvents.UnequipItemHandle","111":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"27_8401342884\",\n    CFrame.new(-669.83062744141, -0.24483019113541, -330.66595458984, -0.42308008670807, 0.0087050162255764, 0.90605050325394, -0.00096587528241798, 0.99994891881943, -0.010058174841106, -0.90609180927277, -0.0051305452361703, -0.42305007576942)\n}","117":"UnequipItemHandle","116":"{\n    \"FireAllClients\",\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Good Sack\"]\n}","114":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"30_8401342884\",\n    CFrame.new(-671.48785400391, -0.24310705065727, -331.9626159668, 0.9111647605896, -0.00192993611563, -0.41203773021698, -0.0013152225874364, 0.9999703168869, -0.0075921765528619, 0.41204014420509, 0.0074596451595426, 0.91113513708115)\n}","113":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"29_8401342884\",\n    CFrame.new(-670.56921386719, -0.2457472383976, -332.73709106445, -0.099429331719875, -0.01010949909687, -0.99499326944351, -0.0015035076066852, 0.99994879961014, -0.010009603574872, 0.99504351615906, 0.0005007311119698, -0.099439434707165)\n}","27":"28ccf5f06f59ba459c891ec5d49a7d4cdac18016b0ffaab2d94d092be58c8608b94406d41acb4a0f1e738db424534b8b","17":"{\n    game:GetService(\"Players\").LocalPlayer\n}","13":"game:GetService(\"ReplicatedStorage\").RemoteEvents.PlayEnemyHitSound","110":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"26_8401342884\",\n    CFrame.new(-673.65893554688, -0.24129545688629, -329.72662353516, -0.16290652751923, -6.3034455877187e-08, 0.98664152622223, -3.4780182289751e-08, 1, 5.814526815584e-08, -0.98664152622223, -2.4843327395274e-08, -0.16290652751923)\n}","33":"game:GetService(\"ReplicatedStorage\").RemoteEvents.ChangeColorCorrection","23":"RemoteFunction","42":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Strong Axe\"],\n    \"3_8401342884\",\n    CFrame.new(-28.417665481567, 1.831552028656, -157.65830993652, 0.99741077423096, 1.3619684047228e-08, 0.071914479136467, -1.5743891523812e-08, 1, 2.8971141929901e-08, -0.071914479136467, -3.0028346031941e-08, 0.99741077423096)\n}","52":"{\n    2,\n    1,\n    {},\n    {\n        npcs = {\n            \"Pelt Trader\"\n        },\n        berries = 0,\n        rain = 19,\n        plants = {},\n        attack = 15\n    }\n}","62":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"7_8401342884\",\n    CFrame.new(-112.14740753174, 0.71222770214081, -193.04559326172, 0.87065494060516, -4.786359752984e-09, 0.49189430475235, 2.0604908002042e-08, 1, -2.6740305969497e-08, -0.49189430475235, 3.3417016709336e-08, 0.87065494060516)\n}","72":"{\n    {\n        RemoteEvent = game:GetService(\"ReplicatedStorage\").RemoteEvents.TargettedSound,\n        BindableEvent = {\n            BindableEvent = .Event --[[Nil Parent]]\n        },\n        Name = \"TargettedSound\"\n    }\n}","36":"{\n    \"Day\",\n    6\n}","46":"{\n    {\n        RemoteEvent = game:GetService(\"ReplicatedStorage\").RemoteEvents.PlayDeathAnimation,\n        BindableEvent = {\n            BindableEvent = .Event --[[Nil Parent]]\n        },\n        Name = \"PlayDeathAnimation\"\n    }\n}","56":"game:GetService(\"ReplicatedStorage\").RemoteEvents.PlayerSprinting","66":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"10_8401342884\",\n    CFrame.new(-182.33320617676, 2.2070255279541, -151.46702575684, -0.8427649140358, -2.3854200392748e-08, 0.53828185796738, -5.4973142482595e-08, 1, -4.1753654755894e-08, -0.53828185796738, -6.4779563047068e-08, -0.8427649140358)\n}","109":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]]\n}","106":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"23_8401342884\",\n    CFrame.new(-611.39642333984, -2.0685081481934, -339.13623046875, -0.91109997034073, -0.014592252671719, -0.41192710399628, -0.0065557877533138, 0.99975973367691, -0.020915761590004, 0.4121333360672, -0.016355842351913, -0.91097670793533)\n}","100":"game:GetService(\"ReplicatedStorage\").RemoteEvents.HealEffects","107":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"24_8401342884\",\n    CFrame.new(-612.68615722656, -2.0671877861023, -339.77752685547, 0.12345040589571, -0.019058475270867, -0.99216771125793, -0.0047341594472528, 0.99979287385941, -0.019793994724751, 0.99233943223953, 0.0071406560018659, 0.12333460897207)\n}","80":"{\n    game:GetService(\"Players\").LocalPlayer.Character,\n    game:GetService(\"Players\").LocalPlayer.Character.Head,\n    workspace.Items[\"Crossbow Cultist\"]\n}","9":"2e33b996824b2fa3923c77a5e8d7e0ce572468b10fcae6dbdd067adefca34b8ccf4a463fada516b603dab7564d4427c8","103":"{\n    \"FireAllClients\",\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear\n}","102":"{\n    {\n        RemoteEvent = game:GetService(\"ReplicatedStorage\").RemoteEvents.HealEffects,\n        BindableEvent = {\n            BindableEvent = .Event --[[Nil Parent]]\n        },\n        Name = \"HealEffects\"\n    }\n}","76":"{\n    {\n        RemoteEvent = game:GetService(\"ReplicatedStorage\").RemoteEvents.FireEnemyProjectile,\n        BindableEvent = {\n            BindableEvent = .Event --[[Nil Parent]]\n        },\n        Name = \"FireEnemyProjectile\"\n    }\n}","108":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"25_8401342884\",\n    CFrame.new(-613.72729492188, -2.1467161178589, -338.71859741211, 0.92013156414032, -0.082477405667305, -0.38282546401024, 0.033209767192602, 0.99048238992691, -0.13357278704643, 0.3901986181736, 0.11019100248814, 0.9141132235527)\n}","90":"{\n    workspace.Items.Cultist,\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"16_8401342884\",\n    CFrame.new(-394.80841064453, 3.1837565898895, -354.32791137695, 0.27665880322456, -5.4061427334773e-08, 0.96096819639206, 1.1327372106962e-07, 1, 2.3646206770422e-08, -0.96096819639206, 1.0231051561505e-07, 0.27665880322456)\n}","83":"{\n    workspace.Items[\"Crossbow Cultist\"],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"12_8401342884\",\n    CFrame.new(-394.80841064453, 3.1837565898895, -354.32791137695, 0.27665880322456, -4.9739412588679e-08, 0.96096819639206, 1.0418534657219e-07, 1, 2.1765153235265e-08, -0.96096819639206, 9.409728107812e-08, 0.27665880322456)\n}","97":"game:GetService(\"ReplicatedStorage\").RemoteEvents.RequestConsumeItem","96":"RequestConsumeItem","95":"{\n    \"FireAllClients\",\n    game:GetService(\"Players\").LocalPlayer.Inventory.MedKit\n}","94":"{\n    workspace.Items.Cultist,\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"20_8401342884\",\n    CFrame.new(-394.34475708008, 3.1837565898895, -353.62283325195, 0.67650729417801, 7.141064628513e-08, 0.7364359498024, -6.313444766981e-10, 1, -9.6387935855091e-08, -0.7364359498024, 6.4742195604595e-08, 0.67650729417801)\n}","93":"{\n    workspace.Items.Cultist,\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"19_8401342884\",\n    CFrame.new(-394.34475708008, 3.1837565898895, -353.62283325195, 0.67650729417801, 3.8287829795536e-08, 0.7364359498024, -6.2534731171127e-08, 1, 5.4551541062153e-09, -0.7364359498024, -4.9743274388447e-08, 0.67650729417801)\n}","92":"{\n    workspace.Items.Cultist,\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"18_8401342884\",\n    CFrame.new(-394.51779174805, 3.1836824417114, -353.80590820312, 0.58689701557159, -5.3523899623542e-06, 0.80966156721115, 1.6939237639235e-06, 1, 5.382780727814e-06, -0.80966156721115, -1.7876330957733e-06, 0.58689701557159)\n}","16":"f19ad1fd75b8e83da90012e26252d020d7fbc9767d26e895a9c605c57c35b8fdd14a730ce0adf6fcd7998351b58a1fea","26":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Strong Axe\"],\n    \"1_8401342884\",\n    CFrame.new(-28.265174865723, 3.2571170330048, -94.784324645996, 0.99351108074188, 1.8100013932099e-08, 0.11373524367809, -2.4185345282035e-08, 1, 5.2124523364228e-08, -0.11373524367809, -5.4537018456813e-08, 0.99351108074188)\n}","91":"{\n    workspace.Items.Cultist,\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"17_8401342884\",\n    CFrame.new(-394.85577392578, 3.1837565898895, -354.18814086914, 0.29842975735664, -2.7061062279898e-09, 0.95443159341812, 4.1960099395055e-08, 1, -1.0284693097162e-08, -0.95443159341812, 4.3117303505369e-08, 0.29842975735664)\n}","12":"PlayEnemyHitSound","22":"ToolDamageObject","32":"ChangeColorCorrection","71":"game:GetService(\"ReplicatedStorage\").RemoteEvents.TargettedSound","61":"{\n    \"FireAllClients\",\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear\n}","51":"game:GetService(\"ReplicatedStorage\").RemoteEvents.DayDisplay","41":"{\n    \"BindableEvent\",\n    \"Fire\"\n}","65":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"9_8401342884\",\n    CFrame.new(-182.12084960938, 2.2000689506531, -151.79794311523, -0.84281724691391, 2.4533338915944e-08, 0.53819984197617, 5.604215758126e-08, 1, 4.2177568104762e-08, -0.53819984197617, 6.5709862440144e-08, -0.84281724691391)\n}","55":"PlayerSprinting","45":"{\n    .Bunny --[[Nil Parent]]\n}","35":"game:GetService(\"Players\").LocalPlayer.PlayerScripts.Client.UtilityModules.Events","59":"{\n    \"RemoteEvent\",\n    \"rawget\",\n    [4] = \"FireServer\",\n    [5] = \"warn\",\n    [7] = \"Remote event does not exist for event\",\n    [8] = \"Name\"\n}","49":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Strong Axe\"],\n    \"6_8401342884\",\n    CFrame.new(-21.726472854614, 3.3727335929871, -88.121467590332, -0.81658262014389, -3.4121654834962e-08, 0.57722860574722, -5.7160210786833e-08, 1, -2.1749400502813e-08, -0.57722860574722, -5.0754692892951e-08, -0.81658262014389)\n}","39":"b59863074110ef6cd2de5475fedf7c990f74608bb25511ed9dd4242b01c20b1d66d38346deaa396d7bd4df562a909adc","29":"OnClientInvoke","99":"HealEffects","89":"{\n    \"FireAllClients\",\n    workspace.Items.Cultist,\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear\n}","79":"game:GetService(\"Players\").LocalPlayer.PlayerScripts.Client.EnemyHandler","69":"{\n    0,\n    60\n}","1":"EquipItemHandle","84":"{\n    workspace.Items[\"Crossbow Cultist\"],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"13_8401342884\",\n    CFrame.new(-394.80841064453, 3.1837565898895, -354.32791137695, 0.27665880322456, 1.5488515359152e-08, 0.96096819639206, -3.2452902587465e-08, 1, -6.774558247713e-09, -0.96096819639206, -2.9311966187606e-08, 0.27665880322456)\n}","3":"game:GetService(\"ReplicatedStorage\").RemoteEvents.EquipItemHandle","2":"RemoteEvent","19":"RequestReplicateSound","4":"FireServer","7":"FireOtherClients","6":"{\n    \"FireAllClients\",\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Strong Axe\"]\n}","25":"InvokeServer","15":"FireAllClients","87":"{\n    workspace.Items[\"Crossbow Cultist\"],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"14_8401342884\",\n    CFrame.new(-394.80841064453, 3.1837565898895, -354.32791137695, 0.27665880322456, 5.0594344713772e-08, 0.96096819639206, -1.0600938793459e-07, 1, -2.2129675869564e-08, -0.96096819639206, -9.5749285833335e-08, 0.27665880322456)\n}","86":"{\n    game:GetService(\"Players\").LocalPlayer.Character,\n    game:GetService(\"Players\").LocalPlayer.Character.MessyHair.Handle,\n    workspace.Items[\"Crossbow Cultist\"]\n}","31":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Strong Axe\"],\n    \"2_8401342884\",\n    CFrame.new(-28.265171051025, 3.2571170330048, -94.784378051758, 0.99351137876511, -2.5931472080742e-08, 0.1137328967452, 3.3574117708213e-08, 1, -6.5282740990824e-08, -0.1137328967452, 6.8677628917158e-08, 0.99351137876511)\n}","21":"{\n    \"FireAllClients\",\n    \"WeaponHit\",\n    {\n        Instance = game:GetService(\"Players\").LocalPlayer.Character.Head,\n        Volume = 0.4\n    }\n}","11":"{\n    \"RemoteEvent\",\n    \"rawget\",\n    [4] = \"FireAllClients\",\n    [5] = \"FireServer\",\n    [6] = \"warn\",\n    [8] = \"Remote event does not exist for event\",\n    [9] = \"Name\"\n}","85":"{\n    Vector3.new(-396.65216064453, 4.1837568283081, -357.93151855469),\n    Vector3.new(0.43187564611435, 0.12282039225101, 0.89353156089783),\n    {\n        ProjectileName = \"Arrow\",\n        ProjectileDamage = 20,\n        Speed = 130,\n        NPCModel = workspace.Items[\"Crossbow Cultist\"],\n        ProjectileGravity = 20\n    }\n}","60":"game:GetService(\"Players\").LocalPlayer.PlayerScripts.Client.InteractionHandler","70":"TargettedSound","40":"{\n    {\n        RemoteEvent = game:GetService(\"ReplicatedStorage\").RemoteEvents.ChangeColorCorrection,\n        BindableEvent = {\n            BindableEvent = .Event --[[Nil Parent]]\n        },\n        Name = \"ChangeColorCorrection\"\n    }\n}","50":"DayDisplay","54":"{\n    \"FireAllClients\",\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear\n}","64":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"8_8401342884\",\n    CFrame.new(-112.1494140625, 0.71222770214081, -193.05030822754, 0.87065750360489, 6.3056999621836e-09, 0.4918897151947, -2.7588622941721e-08, 1, 3.6013236837107e-08, -0.4918897151947, -4.4925755560143e-08, 0.87065750360489)\n}","34":"OnClientEvent","44":"game:GetService(\"ReplicatedStorage\").RemoteEvents.PlayDeathAnimation","48":"{\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Strong Axe\"],\n    \"5_8401342884\",\n    CFrame.new(-21.141645431519, 1.6145405769348, -107.50433349609, -0.97916412353516, 3.8103461719174e-08, -0.20307046175003, 3.033798634533e-08, 1, 4.1353093394036e-08, 0.20307046175003, 3.4330717824105e-08, -0.97916412353516)\n}","58":"1b2d4949afd8b607ac99af47c0cdec21e269b700bc232c79b3f29be40caf0ed317939211a160381d98d50756ad4d9a57","28":"{\n    \"RemoteFunction\",\n    \"rawget\",\n    [4] = \"InvokeServer\",\n    [5] = \"warn\",\n    [7] = \"Remote function does not exist for event\",\n    [8] = \"Name\"\n}","38":"Unknown","88":"{\n    workspace.Items[\"Crossbow Cultist\"],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"15_8401342884\",\n    CFrame.new(-394.80841064453, 3.1837565898895, -354.32791137695, 0.27665880322456, -5.4061427334773e-08, 0.96096819639206, 1.1327372106962e-07, 1, 2.3646206770422e-08, -0.96096819639206, 1.0231051561505e-07, 0.27665880322456)\n}","98":"{\n    .MedKit --[[Nil Parent]]\n}","68":"game:GetService(\"ReplicatedStorage\").RemoteEvents.AnalyticsTimeFirstPerson","78":"game:GetService(\"ReplicatedStorage\").RemoteEvents.NPCProjectileDamagePlayer","82":"{\n    workspace.Items[\"Crossbow Cultist\"],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"11_8401342884\",\n    CFrame.new(-393.6252746582, 3.1837561130524, -353.98739624023, 0.27665901184082, -2.1737944777556e-08, 0.96096813678741, 4.5505164081305e-08, 1, 9.5201189154182e-09, -0.96096813678741, 4.1095187697238e-08, 0.27665901184082)\n}","81":"{\n    \"FireAllClients\",\n    workspace.Items[\"Crossbow Cultist\"],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear\n}","105":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"22_8401342884\",\n    CFrame.new(-611.22369384766, -2.0616061687469, -337.70883178711, -0.83589965105057, 2.760593451967e-05, 0.5488823056221, -8.1774109276012e-05, 1, -0.00017482960538473, -0.5488823056221, -0.0001910243590828, -0.83589959144592)\n}","77":"NPCProjectileDamagePlayer","101":"{\n    \"MedKit\"\n}","18":"{\n    \"BindableEvent\",\n    \"Fire\",\n    \"RemoteEvent\",\n    \"rawget\",\n    [6] = \"FireAllClients\",\n    [7] = \"FireServer\",\n    [8] = \"warn\",\n    [10] = \"Remote event does not exist for event\",\n    [11] = \"Name\"\n}","75":"{\n    Vector3.new(-396.65216064453, 4.1837568283081, -357.93151855469),\n    Vector3.new(0.88840371370316, 0.029274895787239, 0.45812854170799),\n    {\n        ProjectileName = \"Arrow\",\n        ProjectileDamage = 20,\n        Speed = 130,\n        NPCModel = workspace.Items[\"Crossbow Cultist\"],\n        ProjectileGravity = 20\n    }\n}","74":"game:GetService(\"ReplicatedStorage\").RemoteEvents.FireEnemyProjectile","14":"{\n    \"FireAllClients\",\n    .Bunny --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory[\"Strong Axe\"]\n}","24":"game:GetService(\"ReplicatedStorage\").RemoteEvents.ToolDamageObject","5":"game:GetService(\"Players\").LocalPlayer.PlayerScripts.LoadClient","104":"{\n    [\"Alpha Wolf\"] --[[Nil Parent]],\n    game:GetService(\"Players\").LocalPlayer.Inventory.Spear,\n    \"21_8401342884\",\n    CFrame.new(-612.44622802734, -2.0583879947662, -336.73135375977, 0.039808988571167, 2.1541765704569e-08, 0.99920731782913, 2.4623520999967e-08, 1, -2.2539870414562e-08, -0.99920731782913, 2.5501291744945e-08, 0.039808988571167)\n}","20":"game:GetService(\"ReplicatedStorage\").RemoteEvents.RequestReplicateSound","30":"{\n    {\n        Success = true\n    }\n}","8":"Players.nsopnet.PlayerScripts.Client.UtilityModules.Events","10":"{}"}
    </script>
    <script type="application/json" id="event-data">
      [[1,2,3,4,1769817019.138698,5,6,4,7,91,8,0,0,9,10,10,11],[12,2,13,4,1769817022.3316284,5,14,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817022.331955,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817022.3337343,5,26,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817022.3905445,5,30,29,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817022.8963733,5,14,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817022.8964914,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817022.896994,5,31,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817023.0466805,5,30,29,25,83,8,0,0,27,10,10,28],[32,2,33,34,1769817026.6140133,35,36,34,37,-1,38,0,0,39,40,10,41],[12,2,13,4,1769817027.0237168,5,14,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817027.023903,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817027.024671,5,42,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817027.0865648,5,30,29,25,83,8,0,0,27,10,10,28],[43,2,44,34,1769817027.0881708,35,45,34,37,-1,38,0,0,39,46,10,41],[12,2,13,4,1769817030.662119,5,14,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817030.662253,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817030.662815,5,47,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817030.7273319,5,30,29,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817031.2761958,5,14,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817031.2763358,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817031.2769635,5,48,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817031.3453775,5,30,29,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817032.935892,5,14,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817032.9361397,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817032.9370659,5,49,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817033.0139724,5,30,29,25,83,8,0,0,27,10,10,28],[43,2,44,34,1769817033.0154098,35,45,34,37,-1,38,0,0,39,46,10,41],[50,2,51,34,1769817035.5967015,35,52,34,37,-1,38,0,0,39,53,10,41],[1,2,3,4,1769817037.7404135,5,54,4,7,91,8,0,0,9,10,10,11],[55,2,56,4,1769817040.0423477,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817040.0817738,5,57,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817043.985562,60,61,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817043.9858018,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817043.9867705,60,62,25,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817044.028086,5,63,4,4,75,8,0,0,58,10,10,59],[22,23,24,29,1769817044.0715626,60,30,29,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817044.611797,60,61,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817044.6119655,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817044.61261,60,64,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817044.6867142,60,30,29,25,83,8,0,0,27,10,10,28],[43,2,44,34,1769817044.6872264,35,45,34,37,-1,38,0,0,39,46,10,41],[55,2,56,4,1769817044.8575984,5,57,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817048.3269978,60,61,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817048.3273566,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817048.3292647,60,65,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817048.396319,60,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817048.4003833,5,63,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817048.8841525,60,61,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817048.884335,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817048.8851984,60,66,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817048.971821,60,30,29,25,83,8,0,0,27,10,10,28],[43,2,44,34,1769817048.9726208,35,45,34,37,-1,38,0,0,39,46,10,41],[55,2,56,4,1769817049.2910598,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817052.1308237,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817052.1546627,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817052.4182175,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817052.7360676,5,57,4,4,75,8,0,0,58,10,10,59],[67,2,68,4,1769817055.777384,5,69,4,4,75,8,0,0,58,10,10,59],[70,2,71,34,1769817061.9835969,35,10,34,37,-1,38,0,0,39,72,10,41],[70,2,71,34,1769817061.9841779,35,10,34,37,-1,38,0,0,39,72,10,41],[73,2,74,34,1769817061.9850653,35,75,34,37,-1,38,0,0,39,76,10,41],[77,2,78,4,1769817062.1203404,79,80,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817062.5698193,60,81,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817062.5700143,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817062.5709389,60,82,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817062.646541,60,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817062.6778043,5,63,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817063.0721212,60,81,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817063.0722295,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817063.0727335,60,83,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817063.1353887,60,30,29,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817063.5599759,60,81,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817063.5601476,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817063.5615714,60,84,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817063.634772,60,30,29,25,83,8,0,0,27,10,10,28],[73,2,74,34,1769817064.0225864,35,85,34,37,-1,38,0,0,39,76,10,41],[77,2,78,4,1769817064.0437506,79,86,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817064.0585488,60,81,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817064.0593062,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817064.0601752,60,87,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817064.1238547,60,30,29,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817064.585226,60,81,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817064.5853806,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817064.5859597,60,88,25,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817064.5862568,60,89,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817064.5863643,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817064.586817,60,90,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817064.7281213,60,30,29,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817064.728597,60,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817064.7362548,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817064.7833718,5,63,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817065.1314188,60,89,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817065.1315447,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817065.132152,60,91,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817065.2240632,60,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817065.3199287,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817065.3625386,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817065.5493363,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817065.5876215,5,63,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817065.6467849,60,89,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817065.6469215,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817065.6475337,60,92,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817065.6994203,60,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817065.9060479,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817065.947489,5,63,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817066.1815625,60,89,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817066.181742,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817066.1824954,60,93,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817066.2824736,60,30,29,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817066.7868915,60,89,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817066.7871814,60,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817066.788368,60,94,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817066.8964992,60,30,29,25,83,8,0,0,27,10,10,28],[1,2,3,4,1769817067.8294075,5,95,4,7,91,8,0,0,9,10,10,11],[96,23,97,25,1769817069.1694866,5,98,25,25,83,8,0,0,27,10,10,28],[96,23,97,29,1769817069.3137077,5,30,29,25,83,8,0,0,27,10,10,28],[99,2,100,34,1769817069.3156303,35,101,34,37,-1,38,0,0,39,102,10,41],[55,2,56,4,1769817069.8710385,5,57,4,4,75,8,0,0,58,10,10,59],[1,2,3,4,1769817070.7170153,5,54,4,7,91,8,0,0,9,10,10,11],[70,2,71,34,1769817077.9257444,35,10,34,37,-1,38,0,0,39,72,10,41],[55,2,56,4,1769817078.7672997,5,63,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817078.7861357,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817078.7865344,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817078.7880643,5,104,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817078.8841336,5,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817078.9186826,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817078.9522343,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817078.9961527,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817079.0732027,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817079.1084808,5,57,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817079.238634,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817079.238887,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817079.2399893,5,105,25,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817079.2623528,5,63,4,4,75,8,0,0,58,10,10,59],[22,23,24,29,1769817079.2932828,5,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817079.2982906,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817079.5108095,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817079.5669382,5,57,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817079.7323175,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817079.7326503,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817079.7338515,5,106,25,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817079.761664,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817079.8017796,5,57,4,4,75,8,0,0,58,10,10,59],[22,23,24,29,1769817079.832545,5,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817079.960271,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817079.997328,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817080.0639086,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817080.0965765,5,57,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817080.2472828,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817080.2474585,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817080.24826,5,107,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817080.3259314,5,30,29,25,83,8,0,0,27,10,10,28],[12,2,13,4,1769817080.7212339,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817080.72152,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817080.7224923,5,108,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817080.8681975,5,30,29,25,83,8,0,0,27,10,10,28],[43,2,44,34,1769817080.8697148,35,109,34,37,-1,38,0,0,39,46,10,41],[55,2,56,4,1769817080.911533,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817081.7009056,5,57,4,4,75,8,0,0,58,10,10,59],[70,2,71,34,1769817082.9996713,35,10,34,37,-1,38,0,0,39,72,10,41],[55,2,56,4,1769817083.893916,5,63,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817083.905387,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817083.9055639,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817083.9062546,5,110,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817083.9559682,5,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817083.9611128,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817084.139064,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817084.3401013,5,57,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817084.3537937,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817084.3539284,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817084.3545566,5,111,25,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817084.3739618,5,63,4,4,75,8,0,0,58,10,10,59],[22,23,24,29,1769817084.3990703,5,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817084.4038544,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817084.4332846,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817084.4664105,5,57,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817084.863933,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817084.8640919,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817084.8647543,5,112,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817084.9156779,5,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817085.1428745,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817085.1742588,5,57,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817085.3641725,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817085.3643208,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817085.3650189,5,113,25,25,83,8,0,0,27,10,10,28],[22,23,24,29,1769817085.4293733,5,30,29,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817085.8667932,5,63,4,4,75,8,0,0,58,10,10,59],[12,2,13,4,1769817085.8874386,5,103,4,15,101,8,0,0,16,17,10,18],[19,2,20,4,1769817085.887772,5,21,4,7,91,8,0,0,9,10,10,11],[22,23,24,25,1769817085.8893984,5,114,25,25,83,8,0,0,27,10,10,28],[55,2,56,4,1769817085.913154,5,57,4,4,75,8,0,0,58,10,10,59],[22,23,24,29,1769817085.979319,5,30,29,25,83,8,0,0,27,10,10,28],[43,2,44,34,1769817085.9801849,35,109,34,37,-1,38,0,0,39,46,10,41],[55,2,56,4,1769817086.0295823,5,63,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817086.0743535,5,57,4,4,75,8,0,0,58,10,10,59],[55,2,56,4,1769817086.109589,5,63,4,4,75,8,0,0,58,10,10,59],[1,2,3,4,1769817094.0088316,5,115,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817094.5857814,5,6,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817094.9249995,5,115,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817095.192602,5,54,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817095.5738896,5,6,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817095.8819447,5,116,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817096.5155969,5,6,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817096.8340359,5,115,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817097.0924032,5,54,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817097.3710163,5,115,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817097.619498,5,6,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817097.8763583,5,116,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817098.140743,5,6,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817098.434761,5,115,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817098.7645424,5,54,4,7,91,8,0,0,9,10,10,11],[1,2,3,4,1769817099.3059645,5,115,4,7,91,8,0,0,9,10,10,11],[117,2,118,4,1769817099.7526458,5,115,4,15,101,8,0,0,16,17,10,18],[1,2,3,4,1769817100.336054,5,6,4,7,91,8,0,0,9,10,10,11],[117,2,118,4,1769817100.7889,5,6,4,15,101,8,0,0,16,17,10,18],[1,2,3,4,1769817101.254529,5,54,4,7,91,8,0,0,9,10,10,11],[117,2,118,4,1769817101.6376677,5,54,4,15,101,8,0,0,16,17,10,18],[1,2,3,4,1769817102.5844985,5,95,4,7,91,8,0,0,9,10,10,11],[117,2,118,4,1769817102.9812995,5,95,4,15,101,8,0,0,16,17,10,18],[1,2,3,4,1769817103.4720577,5,6,4,7,91,8,0,0,9,10,10,11],[117,2,118,4,1769817103.783114,5,6,4,15,101,8,0,0,16,17,10,18]]
    </script>

    <script>
      // Data Parsing
      let startTime = 1769817009.264739; // Seconds
      const totalDuration = 94.20731854438782;
      const dictionary = JSON.parse(document.getElementById('dictionary-data').textContent);
      const rawEvents = JSON.parse(document.getElementById('event-data').textContent);

      // Reconstruct Events
      const allEvents = rawEvents.map(e => ({
        name: dictionary[e[0]],
        className: dictionary[e[1]],
        path: dictionary[e[2]],
        type: dictionary[e[3]],
        timestamp: e[4],
        origin: dictionary[e[5]],

        args: dictionary[e[6]],
        method: dictionary[e[7]],

        funcName: dictionary[e[8]],
        funcLine: e[9],
        funcSource: dictionary[e[10]],
        isExecutor: e[11] === 1,
        isActor: e[12] === 1,

        funcHash: dictionary[e[13]],
        upvalues: dictionary[e[14]],
        protos: dictionary[e[15]],
        constants: dictionary[e[16]]
      }));

      if (allEvents.length > 0) {
        const minTimestamp = Math.min(...allEvents.map(e => e.timestamp));
        if (minTimestamp < startTime) {
          startTime = minTimestamp;
        }
      }

      // Preprocess events
      allEvents.forEach(evt => {
        evt.relTime = Math.max(0, evt.timestamp - startTime);

        const typeLower = evt.type.toLowerCase();
        const methodLower = evt.method ? evt.method.toLowerCase() : '';

        if (methodLower.includes('client') || typeLower.includes('client')) {
          evt.typeClass = 'incoming';
        } else {
          evt.typeClass = 'outgoing';
        }
      });

      // State
      let filteredEvents = allEvents;
      let zoomLevel = 1;
      let selectedEvent = null;
      let filterTimeout = null;
      let filterMinTime = 0;
      let filterMaxTime = totalDuration;

      // Initialize Time Inputs
      document.getElementById('minTimeInput').value = "0";
      document.getElementById('maxTimeInput').value = totalDuration.toFixed(2);

      // Virtual Scroll State
      let lastStartIndex = -1;
      let lastEndIndex = -1;
      let isScrolling = false;

      // DOM Elements
      const rowsContainer = document.getElementById('rowsContainer');
      const virtualSpacer = document.getElementById('virtualSpacer');
      const virtualContent = document.getElementById('virtualContent');
      const rulerContainer = document.getElementById('ruler');
      const detailsPanel = document.getElementById('detailsPanel');
      const detailsContent = document.getElementById('detailsContent');
      const timelineHeader = document.getElementById('timelineHeader');
      const statsLabel = document.getElementById('statsLabel');


      // Heatmap State
      let currentView = 'timeline';
      let heatmapZoom = 1;
      let detailsWasVisible = false;
      const heatmapCanvas = document.getElementById('heatmapCanvas');
      const heatmapTooltip = document.getElementById('heatmapTooltip');

      const timelinePanel = document.getElementById('timelinePanel');
      const heatmapPanel = document.getElementById('heatmapPanel');

      // Heatmap Interaction
      heatmapCanvas.addEventListener('wheel', (e) => {
        if (currentView !== 'heatmap') return;
        e.preventDefault();

        const delta = e.deltaY > 0 ? 1.1 : 0.9;
        heatmapZoom = Math.max(1, Math.min(50, heatmapZoom * delta));
        renderHeatmap();
      }, { passive: false });

      heatmapCanvas.addEventListener('mousemove', (e) => {
        if (currentView !== 'heatmap') return;
        const rect = heatmapCanvas.getBoundingClientRect();
        const x = e.clientX - rect.left;
        const y = e.clientY - rect.top;

        if (!window.lastHeatmapData) return;

        const { sortedRemotes, rowHeight, binWidth, remotes, maxBinCount, timeBins, binDuration, margin, scrollLeft } = window.lastHeatmapData;
        const width = heatmapPanel.clientWidth;
        const height = heatmapPanel.clientHeight;

        if (x < margin.left || x > width - margin.right || y < margin.top || y > height - margin.bottom) {
          heatmapTooltip.style.display = 'none';
          return;
        }

        const rowIndex = Math.floor((y - margin.top) / rowHeight);

        // Calculate colIndex based on virtual position (x + scrollLeft)
        const colIndex = Math.floor((x - margin.left + scrollLeft) / binWidth);

        if (rowIndex >= 0 && rowIndex < sortedRemotes.length && colIndex >= 0 && colIndex < timeBins) {
          const remote = sortedRemotes[rowIndex];
          // Calculate count for this bin
          let count = 0;
          remotes[remote].forEach(evt => {
            const binIndex = Math.min(Math.floor(evt.relTime / binDuration), timeBins - 1);
            if (binIndex === colIndex) count++;
          });

          heatmapTooltip.style.display = 'block';
          heatmapTooltip.innerHTML = `<b>${remote}</b><br>Time: ${(colIndex * binDuration).toFixed(1)}s<br>Count: ${count}`;

          const tooltipWidth = heatmapTooltip.offsetWidth;
          const panelWidth = heatmapPanel.clientWidth;

          let leftPos = x + 10;
          if (leftPos + tooltipWidth > panelWidth - 10) {
            leftPos = x - tooltipWidth - 10;
          }

          heatmapTooltip.style.left = leftPos + 'px';
          heatmapTooltip.style.top = (y + 10) + 'px';
        } else {
          heatmapTooltip.style.display = 'none';
        }
      });

      heatmapCanvas.addEventListener('mouseleave', () => {
        heatmapTooltip.style.display = 'none';
      });

      document.getElementById('heatmapScroll').addEventListener('scroll', () => {
        if (currentView === 'heatmap') {
          renderHeatmap();
        }
      });

      function switchView(view) {
        currentView = view;
        document.querySelectorAll('.view-btn').forEach(btn => {
          btn.classList.toggle('active', btn.innerText.toLowerCase() === view);
        });

        if (view === 'timeline') {
          timelinePanel.style.display = 'flex';
          heatmapPanel.classList.remove('visible');

          if (detailsWasVisible) {
            detailsPanel.classList.add('visible');
          }

          renderVirtualRows(true);
        } else {
          if (detailsPanel.classList.contains('visible')) {
            detailsWasVisible = true;
            detailsPanel.classList.remove('visible');
          } else {
            detailsWasVisible = false;
          }

          timelinePanel.style.display = 'none';
          heatmapPanel.classList.add('visible');
          renderHeatmap();
        }
      }

      function renderHeatmap() {
        const ctx = heatmapCanvas.getContext('2d');
        const containerWidth = heatmapPanel.clientWidth;
        const height = heatmapPanel.clientHeight;
        const scrollLeft = document.getElementById('heatmapScroll').scrollLeft;

        // Calculate total virtual width
        const totalWidth = containerWidth * heatmapZoom;

        // Update Spacer
        document.getElementById('heatmapSpacer').style.width = totalWidth + 'px';

        const dpr = window.devicePixelRatio || 1;

        // Canvas is always viewport size
        heatmapCanvas.width = containerWidth * dpr;
        heatmapCanvas.height = height * dpr;
        ctx.scale(dpr, dpr);

        ctx.fillStyle = '#0d1117';
        ctx.fillRect(0, 0, containerWidth, height);

        if (filteredEvents.length === 0) return;

        const remotes = {};
        filteredEvents.forEach(evt => {
          if (!remotes[evt.name]) remotes[evt.name] = [];
          remotes[evt.name].push(evt);
        });

        const sortedRemotes = Object.keys(remotes).sort((a, b) => remotes[b].length - remotes[a].length);

        const margin = { top: 30, right: 20, bottom: 20, left: 150 };

        // Virtual chart width
        const chartWidth = totalWidth - margin.left - margin.right;
        const chartHeight = height - margin.top - margin.bottom;

        // Apply Zoom to time bins
        const timeBins = Math.floor(100 * heatmapZoom);
        const binWidth = chartWidth / timeBins;
        const binDuration = totalDuration / timeBins;

        // Adjust row height to fit
        const rowHeight = Math.min(30, chartHeight / sortedRemotes.length);

        // Store data for tooltip (adjusted for virtual scroll)
        window.lastHeatmapData = { sortedRemotes, rowHeight, binWidth, remotes, timeBins, binDuration, margin, scrollLeft };

        ctx.strokeStyle = '#30363d';
        ctx.lineWidth = 1;

        ctx.font = '11px -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif';
        ctx.textAlign = 'right';
        ctx.textBaseline = 'middle';

        let maxBinCount = 0;
        sortedRemotes.forEach(remote => {
          const bins = new Array(timeBins).fill(0);
          remotes[remote].forEach(evt => {
            const binIndex = Math.min(Math.floor(evt.relTime / binDuration), timeBins - 1);
            bins[binIndex]++;
          });
          maxBinCount = Math.max(maxBinCount, ...bins);
        });

        // Update Legend Labels
        window.lastHeatmapData.maxBinCount = maxBinCount;
        window.lastHeatmapData.maxBinCount = maxBinCount;

        sortedRemotes.forEach((remote, i) => {
          const y = margin.top + (i * rowHeight);

          // Draw Label (Fixed position)
          ctx.fillStyle = '#8b949e';
          ctx.fillText(remote.length > 20 ? remote.slice(0, 18) + '...' : remote, margin.left - 10, y + rowHeight / 2);

          // Draw Line
          ctx.beginPath();
          ctx.moveTo(margin.left, y);
          ctx.lineTo(containerWidth - margin.right, y);
          ctx.stroke();

          const bins = new Array(timeBins).fill(0);
          remotes[remote].forEach(evt => {
            const binIndex = Math.min(Math.floor(evt.relTime / binDuration), timeBins - 1);
            bins[binIndex]++;
          });

          bins.forEach((count, binIndex) => {
            if (count === 0) return;

            // Calculate virtual X
            const virtualX = margin.left + (binIndex * binWidth);

            // Apply scroll offset
            const screenX = virtualX - scrollLeft;

            // Only draw if visible
            if (screenX + binWidth < margin.left || screenX > containerWidth - margin.right) return;

            // Clamp to chart area
            const drawX = Math.max(margin.left, screenX);
            const drawWidth = Math.min(binWidth, (containerWidth - margin.right) - drawX);

            const intensity = count / maxBinCount;
            const hue = (1 - intensity) * 240;
            ctx.fillStyle = `hsla(${hue}, 70%, 50%, 0.8)`;

            ctx.fillRect(drawX, y + 2, drawWidth - 1, rowHeight - 4);
          });
        });

        ctx.fillStyle = '#8b949e';
        ctx.textAlign = 'center';
        ctx.textBaseline = 'top';

        const numTicks = 5 * Math.ceil(heatmapZoom);

        for (let i = 0; i <= numTicks; i++) {
          const virtualX = margin.left + (chartWidth * (i / numTicks));
          const screenX = virtualX - scrollLeft;

          if (screenX < margin.left || screenX > containerWidth - margin.right) continue;

          const time = (totalDuration * (i / numTicks)).toFixed(1) + 's';
          ctx.fillText(time, screenX, margin.top - 20);

          ctx.beginPath();
          ctx.moveTo(screenX, margin.top);
          ctx.lineTo(screenX, height - margin.bottom);
          ctx.stroke();
        }
      }

      // Resize observer for heatmap
      new ResizeObserver(() => {
        if (currentView === 'heatmap' && heatmapPanel.classList.contains('visible')) {
          renderHeatmap();
        }
      }).observe(heatmapPanel);

      // Window resize handler for timeline
      window.addEventListener('resize', () => {
        if (currentView === 'timeline') {
          renderVirtualRows(true);
          renderRuler();
        }
      });

      // Virtual Scroll Config
      const ROW_HEIGHT = 29; // 28px + 1px border
      const BUFFER_SIZE = 5;

      function formatTime(seconds) {
        if (seconds < 1) return (seconds * 1000).toFixed(1) + 'ms';
        return seconds.toFixed(2) + 's';
      }

      function formatAbsTime(timestamp) {
        const date = new Date(timestamp * 1000);
        return date.toLocaleTimeString();
      }

      function getIconUrl(className) {
        return `https://robloxapi.github.io/ref/icons/dark/${className}.png`;
      }

      function escapeHtml(text) {
        if (!text) return '';
        return text
          .replace(/&/g, "&amp;")
          .replace(/</g, "&lt;")
          .replace(/>/g, "&gt;")
          .replace(/"/g, "&quot;")
          .replace(/'/g, "&#039;");
      }

      function syntaxHighlight(text) {
        if (!text) return '';

        text = escapeHtml(text);
        return text
          .replace(/&quot;((?:[^&]|&(?!(quot;)))*)&quot;/g, '<span class="hl-str">"$1"</span>')
          .replace(/\b(\d+(\.\d+)?)\b/g, '<span class="hl-num">$1</span>')
          .replace(/\b(true|false)\b/g, '<span class="hl-bool">$1</span>')
          .replace(/\b(nil)\b/g, '<span class="hl-nil">$1</span>');
      }

      // Toast Logic
      function showToast(message) {
        const toast = document.getElementById('toast');
        const msgSpan = document.getElementById('toastMessage');
        msgSpan.innerText = message;
        toast.classList.add('visible');
        setTimeout(() => {
          toast.classList.remove('visible');
        }, 2000);
      }

      function copyText(text, message = "Copied to clipboard") {
        navigator.clipboard.writeText(text).then(() => {
          showToast(message);
        });
      }

      function copyArgs(btn) {
        if (selectedEvent) {
          navigator.clipboard.writeText(selectedEvent.args).then(() => {
            btn.classList.add('copied');
            setTimeout(() => btn.classList.remove('copied'), 2000);
          });
        }
      }

      function toggleCallerDropdown(e) {
        e.stopPropagation();
        const menu = document.getElementById('callerDropdown');
        if (menu) {
          menu.classList.toggle('visible');
        }
      }

      function copyCallerData(type) {
        if (!selectedEvent) return;
        let text = "";
        let msg = "Copied to clipboard";
        switch (type) {
          case 'hash':
            text = selectedEvent.funcHash || "N/A";
            msg = "Function Hash copied";
            break;
          case 'upvalues':
            text = selectedEvent.upvalues || "{}";
            msg = "Upvalues copied";
            break;
          case 'protos':
            text = selectedEvent.protos || "[]";
            msg = "Protos copied";
            break;
          case 'path':
            text = selectedEvent.origin || "N/A";
            msg = "Script Path copied";
            break;
          case 'source':
            text = selectedEvent.funcSource || "N/A";
            msg = "Source copied";
            break;
        }
        copyText(text, msg);
        document.getElementById('callerDropdown').classList.remove('visible');
      }

      // Render Ruler
      function renderRuler() {
        rulerContainer.innerHTML = '';
        const tickCount = Math.max(5, Math.floor(5 * zoomLevel));
        for (let i = 0; i <= tickCount; i++) {
          const pct = (i / tickCount) * 100;
          const time = (totalDuration * (i / tickCount));
          const tick = document.createElement('div');
          tick.className = 'tick';
          tick.style.left = pct + '%';
          tick.innerText = formatTime(time);
          rulerContainer.appendChild(tick);
        }
      }

      // Scroll Sync
      rowsContainer.addEventListener('scroll', () => {
        timelineHeader.scrollLeft = rowsContainer.scrollLeft;
      });

      // Virtual Rendering
      function renderVirtualRows(force = false) {
        const scrollTop = rowsContainer.scrollTop;
        const containerHeight = rowsContainer.clientHeight;

        const totalHeight = filteredEvents.length * ROW_HEIGHT;
        virtualSpacer.style.height = totalHeight + 'px';

        const startIndex = Math.floor(scrollTop / ROW_HEIGHT);
        const endIndex = Math.min(filteredEvents.length, Math.ceil((scrollTop + containerHeight) / ROW_HEIGHT) + BUFFER_SIZE);

        if (!force && startIndex === lastStartIndex && endIndex === lastEndIndex) {
          return;
        }

        lastStartIndex = startIndex;
        lastEndIndex = endIndex;

        const visibleEvents = filteredEvents.slice(Math.max(0, startIndex - BUFFER_SIZE), endIndex);
        const startOffset = Math.max(0, startIndex - BUFFER_SIZE) * ROW_HEIGHT;

        virtualContent.style.transform = `translateY(${startOffset}px)`;

        const fragment = document.createDocumentFragment();
        const zoomWidth = (100 * zoomLevel) + '%';

        // Sync Ruler Width
        document.getElementById('ruler').style.width = zoomWidth;

        visibleEvents.forEach((evt) => {
          const row = document.createElement('div');
          row.className = 'trace-row';
          if (selectedEvent === evt) row.classList.add('selected');

          row.evtData = evt;
          row.onclick = function () { selectRow(this, evt); };

          const listCol = document.createElement('div');
          listCol.className = 'row-list';
          listCol.innerHTML = `
                    <div class="type-icon" style="background-image: url('${getIconUrl(evt.className)}')"></div>
                    <div class="remote-name" title="${evt.name}">${evt.name}</div>
                `;

          const timelineCol = document.createElement('div');
          timelineCol.className = 'row-timeline';
          timelineCol.style.width = zoomWidth;
          timelineCol.style.flex = 'none';

          const marker = document.createElement('div');
          marker.className = `timeline-marker ${evt.typeClass}`;

          let leftPct = ((evt.relTime) / totalDuration) * 100;
          if (leftPct > 99) leftPct = 99;

          let widthPct = (0.05 / totalDuration) * 100;
          if (widthPct < 1) widthPct = 1;

          marker.style.left = leftPct + '%';
          marker.style.width = widthPct + '%';

          timelineCol.appendChild(marker);
          row.appendChild(listCol);
          row.appendChild(timelineCol);
          fragment.appendChild(row);
        });

        virtualContent.innerHTML = '';
        virtualContent.appendChild(fragment);
      }

      // Ctrl+F Handler
      document.addEventListener('keydown', function (e) {
        if ((e.ctrlKey || e.metaKey) && e.key === 'f') {
          e.preventDefault();
          const filterInput = document.getElementById('filterInput');
          filterInput.focus();
          filterInput.select();
        }
      });

      // Initial Render
      renderVirtualRows();
      renderRuler();

      function selectRow(el, evt) {
        const prev = virtualContent.querySelector('.trace-row.selected');
        if (prev) prev.classList.remove('selected');

        el.classList.add('selected');
        selectedEvent = evt;

        detailsPanel.classList.add('visible');

        const isIncoming = evt.typeClass === 'incoming';
        const badgeClass = isIncoming ? 'incoming' : 'outgoing';

        // Flags with Unified Style
        let flagsHtml = '';
        if (evt.isExecutor) {
          flagsHtml += `<div class="badge-pill executor">Executor</div>`;
        }
        if (evt.isActor) {
          flagsHtml += `<div class="badge-pill actor">Actor</div>`;
        }
        if (!flagsHtml) flagsHtml = '<span style="color:var(--text-secondary); font-size:11px;">None</span>';

        const highlightedArgs = syntaxHighlight(evt.args);

        // Icons
        const copyIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy icon-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>`;
        const checkIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-check icon-check"><path d="M20 6 9 17l-5-5"/></svg>`;
        const parenthesesIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-parentheses"><path d="M8 21s-4-3-4-9 4-9 4-9"/><path d="M16 3s4 3 4 9-4 9-4 9"/></svg>`;

        // Dropdown Icons
        const hashIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-hash"><line x1="4" x2="20" y1="9" y2="9"/><line x1="4" x2="20" y1="15" y2="15"/><line x1="10" x2="8" y1="3" y2="21"/><line x1="16" x2="14" y1="3" y2="21"/></svg>`;
        const upvaluesIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-a-arrow-up"><path d="m14 11 4-4 4 4"/><path d="M18 16V7"/><path d="m2 16 4.039-9.69a.5.5 0 0 1 .923 0L11 16"/><path d="M3.304 13h6.392"/></svg>`;
        const protosIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-function"><rect width="18" height="18" x="3" y="3" rx="2" ry="2"/><path d="M9 17c2 0 2.8-1 2.8-2.8V10c0-2 1-3.3 3.2-3"/><path d="M9 11.2h5.7"/></svg>`;
        const pathIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-route"><circle cx="6" cy="19" r="3"/><path d="M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15"/><circle cx="18" cy="5" r="3"/></svg>`;
        const sourceIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-code"><path d="m16 18 6-6-6-6"/><path d="m8 6-6 6 6 6"/></svg>`;
        const boxIcon = `<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-box"><path d="M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z"/><path d="m3.3 7 8.7 5 8.7-5"/><path d="M12 22v-9"/></svg>`;

        detailsContent.innerHTML = `
                <div class="details-header-top">
                    <div class="details-title-group">
                        <div class="details-icon-large" style="background-image: url('${getIconUrl(evt.className)}')"></div>
                        <div class="details-name-large">${escapeHtml(evt.name)}</div>
                    </div>
                    <div class="details-actions">
                        <div class="badge-pill ${badgeClass}">${evt.typeClass.toUpperCase()}</div>
                        <div class="close-btn" onclick="closeDetails()">Ã—</div>
                    </div>
                </div>

                <div class="details-path-row" onclick="copyText('${escapeHtml(evt.path).replace(/'/g, "\\'").replace(/"/g, "&quot;")}', 'Remote Path copied')" title="Click to copy path"><span class="clickable-path">${escapeHtml(evt.path)}</span></div>

                <div class="info-grid">
                    <div class="info-item">
                        <h4>Method</h4>
                        <div>${escapeHtml(evt.method)}</div>
                    </div>
                    <div class="info-item">
                        <h4>Timestamp</h4>
                        <div>${formatAbsTime(evt.timestamp)} <span style="color:var(--text-secondary)">(+${formatTime(evt.relTime)})</span></div>
                    </div>
                    <div class="info-item">
                        <h4>ClassName</h4>
                        <div>${escapeHtml(evt.className)}</div>
                    </div>
                    <div class="info-item">
                        <h4>Remote Path</h4>
                        <div class="remote-path-copy clickable-path" onclick="copyText('${escapeHtml(evt.path).replace(/'/g, "\\'").replace(/"/g, "&quot;")}', 'Remote Path copied')" title="Click to copy path">${escapeHtml(evt.path)}</div>
                    </div>
                </div>

                <div class="content-box">
                    <div class="box-title">Caller Data</div>
                    <button class="copy-icon-btn" onclick="toggleCallerDropdown(event)" title="Copy Caller Info">${copyIcon}</button>

                    <div id="callerDropdown" class="dropdown-menu">
                        <div class="dropdown-item" onclick="copyCallerData('hash')">${hashIcon} Function Hash</div>
                        <div class="dropdown-item" onclick="copyCallerData('upvalues')">${upvaluesIcon} Upvalues</div>
                        <div class="dropdown-item" onclick="copyCallerData('protos')">${protosIcon} Protos</div>
                        <div class="dropdown-item" onclick="copyCallerData('constants')">${boxIcon} Constants</div>
                        <div class="dropdown-item" onclick="copyCallerData('path')">${pathIcon} Script Path</div>
                        <div class="dropdown-item" onclick="copyCallerData('source')">${sourceIcon} Func Source</div>
                    </div>

                    <div class="caller-header">
                        <div class="caller-icon">${parenthesesIcon}</div>
                        <div class="caller-info">
                            <div class="caller-name">${escapeHtml(evt.funcName)} <span class="caller-source">:${evt.funcLine}</span></div>
                            <div class="caller-source">${escapeHtml(evt.funcSource)}</div>
                        </div>
                    </div>

                    <div class="info-grid-2" style="margin-bottom:0; gap:10px;">
                         <div class="info-item-2" style="margin-right: 100px;">
                            <h4>Flags</h4>
                            <div class="flags-row">${flagsHtml}</div>
                         </div>
                         <div class="info-item-2">
                            <h4>Origin</h4>
                            <div class="origin-row clickable-path" onclick="copyText('${escapeHtml(evt.origin).replace(/'/g, "\\'").replace(/"/g, "&quot;")}', 'Origin copied')" title="Click to copy origin">${escapeHtml(evt.origin)}</div>
                         </div>
                    </div>
                </div>

                <div class="content-box">
                    <div class="box-title">Arguments</div>
                    <button class="copy-icon-btn" onclick="copyArgs(this)" title="Copy Arguments">
                        ${copyIcon}
                        ${checkIcon}
                    </button>
                    <div class="args-content">${highlightedArgs}</div>
                </div>
            `;
      }

      function closeDetails() {
        detailsPanel.classList.remove('visible');
        const prev = virtualContent.querySelector('.trace-row.selected');
        if (prev) prev.classList.remove('selected');
        selectedEvent = null;
      }

      function handleFilterInput() {
        if (filterTimeout) clearTimeout(filterTimeout);
        filterTimeout = setTimeout(applyFilters, 300);
      }

      function toggleSearchOptions() {
        const widget = document.getElementById('searchChevron').closest('.search-widget');
        const options = document.getElementById('searchOptions');
        const chevron = document.getElementById('searchChevron');

        options.classList.toggle('visible');
        chevron.classList.toggle('expanded');
        widget.classList.toggle('expanded');
      }

      function handleTimeInput() {
        const minVal = parseFloat(document.getElementById('minTimeInput').value);
        const maxVal = parseFloat(document.getElementById('maxTimeInput').value);
        const unit = parseFloat(document.getElementById('timeUnitSelect').value);

        filterMinTime = isNaN(minVal) ? 0 : minVal * unit;
        filterMaxTime = isNaN(maxVal) ? totalDuration : maxVal * unit;

        if (filterTimeout) clearTimeout(filterTimeout);
        filterTimeout = setTimeout(applyFilters, 300);
      }

      function applyFilters() {
        const query = document.getElementById('filterInput').value.toLowerCase();
        const checkIncoming = document.getElementById('filterIncoming').checked;
        const checkOutgoing = document.getElementById('filterOutgoing').checked;
        const checkActor = document.getElementById('filterActor').checked;
        const checkNonActor = document.getElementById('filterNonActor').checked;
        const checkArgs = document.getElementById('filterArgs').checked;
        const checkProto = document.getElementById('filterProto').checked;
        const checkConst = document.getElementById('filterConst').checked;
        const checkHash = document.getElementById('filterHash').checked;
        const checkSource = document.getElementById('filterSource').checked;

        filteredEvents = allEvents.filter(evt => {
          // Filter by Type (Incoming/Outgoing)
          if (checkIncoming || checkOutgoing) {
            const isIncoming = evt.typeClass === 'incoming';
            const isOutgoing = evt.typeClass === 'outgoing';
            if (!((checkIncoming && isIncoming) || (checkOutgoing && isOutgoing))) {
              return false;
            }
          }

          // Filter by Actor Status
          if (checkActor || checkNonActor) {
            const isActor = evt.isActor;
            const isNonActor = !evt.isActor;
            if (!((checkActor && isActor) || (checkNonActor && isNonActor))) {
              return false;
            }
          }

          let matchesText = !query;

          if (!matchesText) {
            // Default search: Name and Type
            if (evt.name.toLowerCase().includes(query) || evt.type.toLowerCase().includes(query)) {
              matchesText = true;
            }
            // Advanced search options
            else {
              if (checkArgs && evt.args && evt.args.toLowerCase().includes(query)) matchesText = true;
              else if (checkProto && evt.protos && evt.protos.toLowerCase().includes(query)) matchesText = true;
              else if (checkConst && evt.constants && evt.constants.toLowerCase().includes(query)) matchesText = true;
              else if (checkHash && evt.funcHash && evt.funcHash.toLowerCase().includes(query)) matchesText = true;
              else if (checkSource && evt.funcSource && evt.funcSource.toLowerCase().includes(query)) matchesText = true;
            }
          }

          const matchesTime = evt.relTime >= filterMinTime && evt.relTime <= filterMaxTime;

          return matchesText && matchesTime;
        });

        // Update Stats
        statsLabel.innerText = `${filteredEvents.length} Events â€¢ ${totalDuration.toFixed(2)}s`;

        // Reset Scroll
        rowsContainer.scrollTop = 0;
        lastStartIndex = -1;
        lastEndIndex = -1;

        if (currentView === 'timeline') {
          renderVirtualRows(true);
        } else {
          renderHeatmap();
        }
      } function updateZoom() {
        const width = (100 * zoomLevel) + '%';
        rulerContainer.style.width = width;
        renderRuler();
        lastStartIndex = -1;
        renderVirtualRows(true);
      }

      rowsContainer.addEventListener('wheel', (e) => {
        if (e.ctrlKey) {
          e.preventDefault();
          if (e.deltaY < 0) {
            zoomLevel = Math.min(zoomLevel * 1.1, 20);
          } else {
            zoomLevel = Math.max(zoomLevel / 1.1, 1);
          }
          updateZoom();
        }
      });

      rowsContainer.addEventListener('scroll', () => {
        timelineHeader.scrollLeft = rowsContainer.scrollLeft;

        if (!isScrolling) {
          window.requestAnimationFrame(() => {
            renderVirtualRows();
            isScrolling = false;
          });
          isScrolling = true;
        }
      });

      const sessionInfo = document.querySelector('.session-info');
      const tooltip = document.querySelector('.session-tooltip');

      sessionInfo.addEventListener('click', (e) => {
        e.stopPropagation();
        tooltip.classList.toggle('visible');
      });

      tooltip.addEventListener('click', (e) => {
        e.stopPropagation();
      });

      document.addEventListener('click', () => {
        tooltip.classList.remove('visible');
        const dropdown = document.getElementById('callerDropdown');
        if (dropdown) dropdown.classList.remove('visible');
      });
    </script>
  </body>
</html>
